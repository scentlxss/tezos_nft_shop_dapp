{"ast":null,"code":"import _regeneratorRuntime from \"/opt/tezos/nft-shop-example/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\n\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nimport { getColorMode } from '../../colorMode';\nimport { replaceInTemplate } from '../../utils/replace-in-template';\nimport { generateGUID } from '../../utils/generate-uuid';\nimport { toastTemplates } from './toast-templates';\nvar document;\n\nif (typeof window !== 'undefined' && typeof window.document !== 'undefined') {\n  document = window.document;\n}\n\nvar EXPAND_AFTER = 5 * 1000;\nvar timeout;\nvar expandTimeout;\nvar globalToastConfig;\n\nvar createActionItem = function createActionItem(toastAction) {\n  return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n    var text, actionText, actionCallback, id, wrapper;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            text = toastAction.text, actionText = toastAction.actionText, actionCallback = toastAction.actionCallback;\n            _context.next = 3;\n            return generateGUID();\n\n          case 3:\n            id = _context.sent;\n            wrapper = document.createElement('div');\n            wrapper.classList.add('beacon-toast__action__item');\n\n            if (actionCallback) {\n              wrapper.innerHTML = text.length > 0 ? \"<p>\".concat(text, \"</p>\") : \"\";\n              wrapper.innerHTML += \"<p><a id=\\\"\".concat(id, \"\\\">\").concat(actionText, \"</a></p>\");\n            } else if (actionText) {\n              wrapper.innerHTML = text.length > 0 ? \"<p class=\\\"beacon-toast__action__item__subtitle\\\">\".concat(text, \"</p>\") : \"\";\n              wrapper.innerHTML += \"<p>\".concat(actionText, \"</p>\");\n            } else {\n              wrapper.innerHTML = \"<p>\".concat(text, \"</p>\");\n            }\n\n            if (actionCallback) {\n              wrapper.addEventListener('click', actionCallback);\n            }\n\n            return _context.abrupt(\"return\", wrapper);\n\n          case 9:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n};\n\nvar removeAllChildNodes = function removeAllChildNodes(parent) {\n  while (parent.firstChild) {\n    parent.removeChild(parent.firstChild);\n  }\n};\n\nvar formatToastText = function formatToastText(html) {\n  var _a, _b;\n\n  var walletIcon = (_a = globalToastConfig === null || globalToastConfig === void 0 ? void 0 : globalToastConfig.walletInfo) === null || _a === void 0 ? void 0 : _a.icon;\n  var walletName = (_b = globalToastConfig === null || globalToastConfig === void 0 ? void 0 : globalToastConfig.walletInfo) === null || _b === void 0 ? void 0 : _b.name;\n  var wallet = '';\n\n  if (walletIcon) {\n    wallet += \"<span class=\\\"beacon-toast__wallet__container\\\"><img class=\\\"beacon-toast__content__img\\\" src=\\\"\".concat(walletIcon, \"\\\">\");\n  }\n\n  if (walletName) {\n    wallet += \"<strong>\".concat(walletName, \"</strong></span>\");\n  } else {\n    wallet += \"Wallet\";\n  }\n\n  return replaceInTemplate(html, 'wallet', wallet);\n};\n\nvar getToastHTML = function getToastHTML(config) {\n  var text = config.body;\n  var html = replaceInTemplate(toastTemplates.default.html, 'text', text);\n  html = formatToastText(html);\n  return {\n    style: toastTemplates.default.css,\n    html: html\n  };\n};\n/**\n * Close a toast\n */\n\n\nvar closeToast = function closeToast() {\n  return new Promise(function (resolve) {\n    var _a;\n\n    globalToastConfig = undefined;\n    var wrapper = document.getElementById('beacon-toast-wrapper');\n\n    if (!wrapper) {\n      return resolve();\n    }\n\n    var elm = (_a = wrapper.shadowRoot) === null || _a === void 0 ? void 0 : _a.getElementById('beacon-toast');\n\n    if (elm) {\n      var animationDuration = 300;\n\n      if (timeout) {\n        clearTimeout(timeout);\n        timeout = undefined;\n      }\n\n      elm.className = elm.className.replace('fadeIn', 'fadeOut');\n      window.setTimeout(function () {\n        var parent = wrapper.parentNode;\n\n        if (parent) {\n          parent.removeChild(wrapper);\n        }\n\n        resolve();\n      }, animationDuration);\n    } else {\n      resolve();\n    }\n  });\n};\n\nvar registerClick = function registerClick(shadowRoot, id, callback) {\n  var button = shadowRoot.getElementById(id);\n\n  if (button) {\n    button.addEventListener('click', function () {\n      return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return callback(button);\n\n              case 2:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n    });\n  }\n\n  return button;\n};\n\nvar showElement = function showElement(shadowRoot, id) {\n  var el = shadowRoot.getElementById(id);\n\n  if (el) {\n    el.classList.remove('hide');\n    el.classList.add('show');\n  }\n};\n\nvar hideElement = function hideElement(shadowRoot, id) {\n  var el = shadowRoot.getElementById(id);\n\n  if (el) {\n    el.classList.add('hide');\n    el.classList.remove('show');\n  }\n}; // const showLoader = (): void => {\n//   showElement('beacon-toast-loader')\n// }\n\n\nvar hideLoader = function hideLoader(shadowRoot) {\n  hideElement(shadowRoot, 'beacon-toast-loader');\n  showElement(shadowRoot, 'beacon-toast-loader-placeholder');\n}; // const showToggle = (): void => {\n//   showElement('beacon-toast-button-expand')\n//   hideElement('beacon-toast-button-close')\n// }\n\n\nvar showClose = function showClose(shadowRoot) {\n  showElement(shadowRoot, 'beacon-toast-button-close');\n  hideElement(shadowRoot, 'beacon-toast-button-expand');\n};\n\nvar collapseList = function collapseList(shadowRoot) {\n  var expandButton = shadowRoot.getElementById('beacon-toast-button-expand');\n  var list = shadowRoot.getElementById('beacon-toast-list');\n\n  if (expandButton && list) {\n    expandButton.classList.remove('beacon-toast__upside_down');\n    list.classList.add('hide');\n    list.classList.remove('show');\n  }\n};\n\nvar expandList = function expandList(shadowRoot) {\n  var expandButton = shadowRoot.getElementById('beacon-toast-button-expand');\n  var list = shadowRoot.getElementById('beacon-toast-list');\n\n  if (expandButton && list) {\n    expandButton.classList.add('beacon-toast__upside_down');\n    list.classList.remove('hide');\n    list.classList.add('show');\n  }\n};\n\nvar expandOrCollapseList = function expandOrCollapseList(shadowRoot) {\n  var expandButton = shadowRoot.getElementById('beacon-toast-button-expand');\n  var list = shadowRoot.getElementById('beacon-toast-list');\n\n  if (expandButton && list) {\n    if (expandButton.classList.contains('beacon-toast__upside_down')) {\n      collapseList(shadowRoot);\n    } else {\n      expandList(shadowRoot);\n    }\n  }\n};\n\nvar addActionsToToast = function addActionsToToast(shadowRoot, toastConfig, list) {\n  return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee4() {\n    var actions, actionPromises, actionItems, poweredByBeacon;\n    return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n      while (1) {\n        switch (_context4.prev = _context4.next) {\n          case 0:\n            actions = toastConfig.actions;\n\n            if (!(actions && actions.length > 0)) {\n              _context4.next = 13;\n              break;\n            }\n\n            actionPromises = actions.map(function (action) {\n              return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee3() {\n                return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n                  while (1) {\n                    switch (_context3.prev = _context3.next) {\n                      case 0:\n                        return _context3.abrupt(\"return\", createActionItem(action));\n\n                      case 1:\n                      case \"end\":\n                        return _context3.stop();\n                    }\n                  }\n                }, _callee3);\n              }));\n            });\n            _context4.next = 5;\n            return Promise.all(actionPromises);\n\n          case 5:\n            actionItems = _context4.sent;\n            actionItems.forEach(function (item) {\n              return list.appendChild(item);\n            });\n            poweredByBeacon = document.createElement('small');\n            poweredByBeacon.classList.add('beacon-toast__powered');\n            poweredByBeacon.innerHTML = toastTemplates.default.poweredByBeacon;\n            list.appendChild(poweredByBeacon);\n            _context4.next = 15;\n            break;\n\n          case 13:\n            showClose(shadowRoot);\n            collapseList(shadowRoot);\n\n          case 15:\n          case \"end\":\n            return _context4.stop();\n        }\n      }\n    }, _callee4);\n  }));\n};\n\nvar createNewToast = function createNewToast(toastConfig) {\n  return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee10() {\n    var timer, shadowRootEl, shadowRoot, wrapper, _getToastHTML, style, html, styleEl, colorMode, elm, list, openWalletButtonEl, closeButton;\n\n    return _regeneratorRuntime.wrap(function _callee10$(_context10) {\n      while (1) {\n        switch (_context10.prev = _context10.next) {\n          case 0:\n            globalToastConfig = toastConfig;\n            timer = toastConfig.timer;\n            shadowRootEl = document.createElement('div');\n            shadowRootEl.setAttribute('id', 'beacon-toast-wrapper');\n            shadowRoot = shadowRootEl.attachShadow({\n              mode: 'open'\n            });\n            wrapper = document.createElement('div');\n            _getToastHTML = getToastHTML(toastConfig), style = _getToastHTML.style, html = _getToastHTML.html;\n            wrapper.innerHTML = html;\n            styleEl = document.createElement('style');\n            styleEl.textContent = style;\n            shadowRoot.appendChild(wrapper);\n            shadowRoot.appendChild(styleEl);\n\n            if (timer) {\n              timeout = window.setTimeout(function () {\n                return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee5() {\n                  return _regeneratorRuntime.wrap(function _callee5$(_context5) {\n                    while (1) {\n                      switch (_context5.prev = _context5.next) {\n                        case 0:\n                          _context5.next = 2;\n                          return closeToast();\n\n                        case 2:\n                        case \"end\":\n                          return _context5.stop();\n                      }\n                    }\n                  }, _callee5);\n                }));\n              }, timer);\n            }\n\n            document.body.prepend(shadowRootEl);\n            colorMode = getColorMode();\n            elm = shadowRoot.getElementById(\"beacon-toast\");\n\n            if (elm) {\n              elm.classList.add(\"theme__\".concat(colorMode));\n            }\n\n            list = shadowRoot.getElementById('beacon-toast-list');\n\n            if (!list) {\n              _context10.next = 21;\n              break;\n            }\n\n            _context10.next = 21;\n            return addActionsToToast(shadowRoot, toastConfig, list);\n\n          case 21:\n            openWalletButtonEl = shadowRoot.getElementById('beacon-open-wallet');\n\n            if (openWalletButtonEl) {\n              if (toastConfig.openWalletAction) {\n                openWalletButtonEl.addEventListener('click', function () {\n                  if (toastConfig.openWalletAction) {\n                    toastConfig.openWalletAction();\n                  }\n                });\n              } else {\n                openWalletButtonEl.classList.add('hide');\n              }\n            }\n\n            if (globalToastConfig.state === 'loading') {\n              expandTimeout = window.setTimeout(function () {\n                return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee6() {\n                  var expandButton;\n                  return _regeneratorRuntime.wrap(function _callee6$(_context6) {\n                    while (1) {\n                      switch (_context6.prev = _context6.next) {\n                        case 0:\n                          expandButton = shadowRoot.getElementById('beacon-toast-button-expand');\n\n                          if (expandButton && !expandButton.classList.contains('beacon-toast__upside_down')) {\n                            expandOrCollapseList(shadowRoot);\n                          }\n\n                        case 2:\n                        case \"end\":\n                          return _context6.stop();\n                      }\n                    }\n                  }, _callee6);\n                }));\n              }, EXPAND_AFTER);\n            }\n\n            registerClick(shadowRoot, 'beacon-toast-button-done', function () {\n              return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee7() {\n                return _regeneratorRuntime.wrap(function _callee7$(_context7) {\n                  while (1) {\n                    switch (_context7.prev = _context7.next) {\n                      case 0:\n                        _context7.next = 2;\n                        return closeToast();\n\n                      case 2:\n                      case \"end\":\n                        return _context7.stop();\n                    }\n                  }\n                }, _callee7);\n              }));\n            });\n            closeButton = registerClick(shadowRoot, 'beacon-toast-button-close', function () {\n              return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee8() {\n                return _regeneratorRuntime.wrap(function _callee8$(_context8) {\n                  while (1) {\n                    switch (_context8.prev = _context8.next) {\n                      case 0:\n                        _context8.next = 2;\n                        return closeToast();\n\n                      case 2:\n                      case \"end\":\n                        return _context8.stop();\n                    }\n                  }\n                }, _callee8);\n              }));\n            });\n\n            if (closeButton && globalToastConfig.state === 'loading') {\n              closeButton.classList.add('hide');\n            }\n\n            registerClick(shadowRoot, 'beacon-toast-button-expand', function () {\n              return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee9() {\n                return _regeneratorRuntime.wrap(function _callee9$(_context9) {\n                  while (1) {\n                    switch (_context9.prev = _context9.next) {\n                      case 0:\n                        expandOrCollapseList(shadowRoot);\n\n                      case 1:\n                      case \"end\":\n                        return _context9.stop();\n                    }\n                  }\n                }, _callee9);\n              }));\n            });\n\n          case 28:\n          case \"end\":\n            return _context10.stop();\n        }\n      }\n    }, _callee10);\n  }));\n};\n\nvar updateToast = function updateToast(toastConfig) {\n  return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee13() {\n    var timer, wrapper, shadowRoot, list, toastTextEl, doneButton;\n    return _regeneratorRuntime.wrap(function _callee13$(_context13) {\n      while (1) {\n        switch (_context13.prev = _context13.next) {\n          case 0:\n            globalToastConfig = Object.assign(Object.assign({}, globalToastConfig), toastConfig);\n            timer = toastConfig.timer;\n            wrapper = document.getElementById('beacon-toast-wrapper');\n\n            if (wrapper) {\n              _context13.next = 5;\n              break;\n            }\n\n            return _context13.abrupt(\"return\");\n\n          case 5:\n            shadowRoot = wrapper.shadowRoot;\n\n            if (shadowRoot) {\n              _context13.next = 8;\n              break;\n            }\n\n            return _context13.abrupt(\"return\");\n\n          case 8:\n            list = shadowRoot.getElementById('beacon-toast-list');\n\n            if (!list) {\n              _context13.next = 13;\n              break;\n            }\n\n            removeAllChildNodes(list);\n            _context13.next = 13;\n            return addActionsToToast(shadowRoot, toastConfig, list);\n\n          case 13:\n            toastTextEl = shadowRoot.getElementById('beacon-text');\n\n            if (toastTextEl) {\n              toastTextEl.innerHTML = formatToastText(toastConfig.body);\n            }\n\n            if (timer) {\n              timeout = window.setTimeout(function () {\n                return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee11() {\n                  return _regeneratorRuntime.wrap(function _callee11$(_context11) {\n                    while (1) {\n                      switch (_context11.prev = _context11.next) {\n                        case 0:\n                          _context11.next = 2;\n                          return closeToast();\n\n                        case 2:\n                        case \"end\":\n                          return _context11.stop();\n                      }\n                    }\n                  }, _callee11);\n                }));\n              }, timer);\n            }\n\n            doneButton = shadowRoot.getElementById('beacon-toast-button-done');\n\n            if (doneButton) {\n              doneButton.addEventListener('click', function () {\n                return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee12() {\n                  return _regeneratorRuntime.wrap(function _callee12$(_context12) {\n                    while (1) {\n                      switch (_context12.prev = _context12.next) {\n                        case 0:\n                          _context12.next = 2;\n                          return closeToast();\n\n                        case 2:\n                        case \"end\":\n                          return _context12.stop();\n                      }\n                    }\n                  }, _callee12);\n                }));\n              });\n            }\n\n          case 18:\n          case \"end\":\n            return _context13.stop();\n        }\n      }\n    }, _callee13);\n  }));\n};\n/**\n * Create a new toast\n *\n * @param toastConfig Configuration of the toast\n */\n\n\nvar openToast = function openToast(toastConfig) {\n  return __awaiter(void 0, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee14() {\n    var _a, wrapper, shadowRoot;\n\n    return _regeneratorRuntime.wrap(function _callee14$(_context14) {\n      while (1) {\n        switch (_context14.prev = _context14.next) {\n          case 0:\n            if (expandTimeout) {\n              clearTimeout(expandTimeout);\n            }\n\n            wrapper = document.getElementById('beacon-toast-wrapper');\n\n            if (!wrapper) {\n              _context14.next = 14;\n              break;\n            }\n\n            if (!toastConfig.forceNew) {\n              _context14.next = 10;\n              break;\n            }\n\n            _context14.next = 6;\n            return closeToast();\n\n          case 6:\n            _context14.next = 8;\n            return createNewToast(toastConfig);\n\n          case 8:\n            _context14.next = 12;\n            break;\n\n          case 10:\n            _context14.next = 12;\n            return updateToast(toastConfig);\n\n          case 12:\n            _context14.next = 16;\n            break;\n\n          case 14:\n            _context14.next = 16;\n            return createNewToast(toastConfig);\n\n          case 16:\n            if (globalToastConfig && globalToastConfig.state === 'finished') {\n              shadowRoot = (_a = document.getElementById('beacon-toast-wrapper')) === null || _a === void 0 ? void 0 : _a.shadowRoot;\n\n              if (shadowRoot) {\n                hideLoader(shadowRoot);\n                showClose(shadowRoot);\n                expandList(shadowRoot);\n              }\n            }\n\n            return _context14.abrupt(\"return\");\n\n          case 18:\n          case \"end\":\n            return _context14.stop();\n        }\n      }\n    }, _callee14);\n  }));\n};\n\nexport { closeToast, openToast };","map":{"version":3,"sources":["../../../../src/ui/toast/Toast.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { getColorMode } from '../../colorMode';\nimport { replaceInTemplate } from '../../utils/replace-in-template';\nimport { generateGUID } from '../../utils/generate-uuid';\nimport { toastTemplates } from './toast-templates';\nlet document;\nif (typeof window !== 'undefined' && typeof window.document !== 'undefined') {\n    document = window.document;\n}\nconst EXPAND_AFTER = 5 * 1000;\nlet timeout;\nlet expandTimeout;\nlet globalToastConfig;\nconst createActionItem = (toastAction) => __awaiter(void 0, void 0, void 0, function* () {\n    const { text, actionText, actionCallback } = toastAction;\n    const id = yield generateGUID();\n    const wrapper = document.createElement('div');\n    wrapper.classList.add('beacon-toast__action__item');\n    if (actionCallback) {\n        wrapper.innerHTML = text.length > 0 ? `<p>${text}</p>` : ``;\n        wrapper.innerHTML += `<p><a id=\"${id}\">${actionText}</a></p>`;\n    }\n    else if (actionText) {\n        wrapper.innerHTML =\n            text.length > 0 ? `<p class=\"beacon-toast__action__item__subtitle\">${text}</p>` : ``;\n        wrapper.innerHTML += `<p>${actionText}</p>`;\n    }\n    else {\n        wrapper.innerHTML = `<p>${text}</p>`;\n    }\n    if (actionCallback) {\n        wrapper.addEventListener('click', actionCallback);\n    }\n    return wrapper;\n});\nconst removeAllChildNodes = (parent) => {\n    while (parent.firstChild) {\n        parent.removeChild(parent.firstChild);\n    }\n};\nconst formatToastText = (html) => {\n    var _a, _b;\n    const walletIcon = (_a = globalToastConfig === null || globalToastConfig === void 0 ? void 0 : globalToastConfig.walletInfo) === null || _a === void 0 ? void 0 : _a.icon;\n    const walletName = (_b = globalToastConfig === null || globalToastConfig === void 0 ? void 0 : globalToastConfig.walletInfo) === null || _b === void 0 ? void 0 : _b.name;\n    let wallet = '';\n    if (walletIcon) {\n        wallet += `<span class=\"beacon-toast__wallet__container\"><img class=\"beacon-toast__content__img\" src=\"${walletIcon}\">`;\n    }\n    if (walletName) {\n        wallet += `<strong>${walletName}</strong></span>`;\n    }\n    else {\n        wallet += `Wallet`;\n    }\n    return replaceInTemplate(html, 'wallet', wallet);\n};\nconst getToastHTML = (config) => {\n    const text = config.body;\n    let html = replaceInTemplate(toastTemplates.default.html, 'text', text);\n    html = formatToastText(html);\n    return {\n        style: toastTemplates.default.css,\n        html\n    };\n};\n/**\n * Close a toast\n */\nconst closeToast = () => new Promise((resolve) => {\n    var _a;\n    globalToastConfig = undefined;\n    const wrapper = document.getElementById('beacon-toast-wrapper');\n    if (!wrapper) {\n        return resolve();\n    }\n    const elm = (_a = wrapper.shadowRoot) === null || _a === void 0 ? void 0 : _a.getElementById('beacon-toast');\n    if (elm) {\n        const animationDuration = 300;\n        if (timeout) {\n            clearTimeout(timeout);\n            timeout = undefined;\n        }\n        elm.className = elm.className.replace('fadeIn', 'fadeOut');\n        window.setTimeout(() => {\n            const parent = wrapper.parentNode;\n            if (parent) {\n                parent.removeChild(wrapper);\n            }\n            resolve();\n        }, animationDuration);\n    }\n    else {\n        resolve();\n    }\n});\nconst registerClick = (shadowRoot, id, callback) => {\n    const button = shadowRoot.getElementById(id);\n    if (button) {\n        button.addEventListener('click', () => __awaiter(void 0, void 0, void 0, function* () {\n            yield callback(button);\n        }));\n    }\n    return button;\n};\nconst showElement = (shadowRoot, id) => {\n    const el = shadowRoot.getElementById(id);\n    if (el) {\n        el.classList.remove('hide');\n        el.classList.add('show');\n    }\n};\nconst hideElement = (shadowRoot, id) => {\n    const el = shadowRoot.getElementById(id);\n    if (el) {\n        el.classList.add('hide');\n        el.classList.remove('show');\n    }\n};\n// const showLoader = (): void => {\n//   showElement('beacon-toast-loader')\n// }\nconst hideLoader = (shadowRoot) => {\n    hideElement(shadowRoot, 'beacon-toast-loader');\n    showElement(shadowRoot, 'beacon-toast-loader-placeholder');\n};\n// const showToggle = (): void => {\n//   showElement('beacon-toast-button-expand')\n//   hideElement('beacon-toast-button-close')\n// }\nconst showClose = (shadowRoot) => {\n    showElement(shadowRoot, 'beacon-toast-button-close');\n    hideElement(shadowRoot, 'beacon-toast-button-expand');\n};\nconst collapseList = (shadowRoot) => {\n    const expandButton = shadowRoot.getElementById('beacon-toast-button-expand');\n    const list = shadowRoot.getElementById('beacon-toast-list');\n    if (expandButton && list) {\n        expandButton.classList.remove('beacon-toast__upside_down');\n        list.classList.add('hide');\n        list.classList.remove('show');\n    }\n};\nconst expandList = (shadowRoot) => {\n    const expandButton = shadowRoot.getElementById('beacon-toast-button-expand');\n    const list = shadowRoot.getElementById('beacon-toast-list');\n    if (expandButton && list) {\n        expandButton.classList.add('beacon-toast__upside_down');\n        list.classList.remove('hide');\n        list.classList.add('show');\n    }\n};\nconst expandOrCollapseList = (shadowRoot) => {\n    const expandButton = shadowRoot.getElementById('beacon-toast-button-expand');\n    const list = shadowRoot.getElementById('beacon-toast-list');\n    if (expandButton && list) {\n        if (expandButton.classList.contains('beacon-toast__upside_down')) {\n            collapseList(shadowRoot);\n        }\n        else {\n            expandList(shadowRoot);\n        }\n    }\n};\nconst addActionsToToast = (shadowRoot, toastConfig, list) => __awaiter(void 0, void 0, void 0, function* () {\n    const actions = toastConfig.actions;\n    if (actions && actions.length > 0) {\n        const actionPromises = actions.map((action) => __awaiter(void 0, void 0, void 0, function* () {\n            // eslint-disable-next-line @typescript-eslint/unbound-method\n            return createActionItem(action);\n        }));\n        const actionItems = yield Promise.all(actionPromises);\n        actionItems.forEach((item) => list.appendChild(item));\n        const poweredByBeacon = document.createElement('small');\n        poweredByBeacon.classList.add('beacon-toast__powered');\n        poweredByBeacon.innerHTML = toastTemplates.default.poweredByBeacon;\n        list.appendChild(poweredByBeacon);\n    }\n    else {\n        showClose(shadowRoot);\n        collapseList(shadowRoot);\n    }\n});\nconst createNewToast = (toastConfig) => __awaiter(void 0, void 0, void 0, function* () {\n    globalToastConfig = toastConfig;\n    const timer = toastConfig.timer;\n    const shadowRootEl = document.createElement('div');\n    shadowRootEl.setAttribute('id', 'beacon-toast-wrapper');\n    const shadowRoot = shadowRootEl.attachShadow({ mode: 'open' });\n    const wrapper = document.createElement('div');\n    const { style, html } = getToastHTML(toastConfig);\n    wrapper.innerHTML = html;\n    const styleEl = document.createElement('style');\n    styleEl.textContent = style;\n    shadowRoot.appendChild(wrapper);\n    shadowRoot.appendChild(styleEl);\n    if (timer) {\n        timeout = window.setTimeout(() => __awaiter(void 0, void 0, void 0, function* () {\n            yield closeToast();\n        }), timer);\n    }\n    document.body.prepend(shadowRootEl);\n    const colorMode = getColorMode();\n    const elm = shadowRoot.getElementById(`beacon-toast`);\n    if (elm) {\n        elm.classList.add(`theme__${colorMode}`);\n    }\n    const list = shadowRoot.getElementById('beacon-toast-list');\n    if (list) {\n        yield addActionsToToast(shadowRoot, toastConfig, list);\n    }\n    const openWalletButtonEl = shadowRoot.getElementById('beacon-open-wallet');\n    if (openWalletButtonEl) {\n        if (toastConfig.openWalletAction) {\n            openWalletButtonEl.addEventListener('click', () => {\n                if (toastConfig.openWalletAction) {\n                    toastConfig.openWalletAction();\n                }\n            });\n        }\n        else {\n            openWalletButtonEl.classList.add('hide');\n        }\n    }\n    if (globalToastConfig.state === 'loading') {\n        expandTimeout = window.setTimeout(() => __awaiter(void 0, void 0, void 0, function* () {\n            const expandButton = shadowRoot.getElementById('beacon-toast-button-expand');\n            if (expandButton && !expandButton.classList.contains('beacon-toast__upside_down')) {\n                expandOrCollapseList(shadowRoot);\n            }\n        }), EXPAND_AFTER);\n    }\n    registerClick(shadowRoot, 'beacon-toast-button-done', () => __awaiter(void 0, void 0, void 0, function* () {\n        yield closeToast();\n    }));\n    const closeButton = registerClick(shadowRoot, 'beacon-toast-button-close', () => __awaiter(void 0, void 0, void 0, function* () {\n        yield closeToast();\n    }));\n    if (closeButton && globalToastConfig.state === 'loading') {\n        closeButton.classList.add('hide');\n    }\n    registerClick(shadowRoot, 'beacon-toast-button-expand', () => __awaiter(void 0, void 0, void 0, function* () {\n        expandOrCollapseList(shadowRoot);\n    }));\n});\nconst updateToast = (toastConfig) => __awaiter(void 0, void 0, void 0, function* () {\n    globalToastConfig = Object.assign(Object.assign({}, globalToastConfig), toastConfig);\n    const timer = toastConfig.timer;\n    const wrapper = document.getElementById('beacon-toast-wrapper');\n    if (!wrapper) {\n        return;\n    }\n    const shadowRoot = wrapper.shadowRoot;\n    if (!shadowRoot) {\n        return;\n    }\n    const list = shadowRoot.getElementById('beacon-toast-list');\n    if (list) {\n        removeAllChildNodes(list);\n        yield addActionsToToast(shadowRoot, toastConfig, list);\n    }\n    const toastTextEl = shadowRoot.getElementById('beacon-text');\n    if (toastTextEl) {\n        toastTextEl.innerHTML = formatToastText(toastConfig.body);\n    }\n    if (timer) {\n        timeout = window.setTimeout(() => __awaiter(void 0, void 0, void 0, function* () {\n            yield closeToast();\n        }), timer);\n    }\n    const doneButton = shadowRoot.getElementById('beacon-toast-button-done');\n    if (doneButton) {\n        doneButton.addEventListener('click', () => __awaiter(void 0, void 0, void 0, function* () {\n            yield closeToast();\n        }));\n    }\n});\n/**\n * Create a new toast\n *\n * @param toastConfig Configuration of the toast\n */\nconst openToast = (toastConfig) => __awaiter(void 0, void 0, void 0, function* () {\n    var _a;\n    if (expandTimeout) {\n        clearTimeout(expandTimeout);\n    }\n    const wrapper = document.getElementById('beacon-toast-wrapper');\n    if (wrapper) {\n        if (toastConfig.forceNew) {\n            yield closeToast();\n            yield createNewToast(toastConfig);\n        }\n        else {\n            yield updateToast(toastConfig);\n        }\n    }\n    else {\n        yield createNewToast(toastConfig);\n    }\n    if (globalToastConfig && globalToastConfig.state === 'finished') {\n        const shadowRoot = (_a = document.getElementById('beacon-toast-wrapper')) === null || _a === void 0 ? void 0 : _a.shadowRoot;\n        if (shadowRoot) {\n            hideLoader(shadowRoot);\n            showClose(shadowRoot);\n            expandList(shadowRoot);\n        }\n    }\n    return;\n});\nexport { closeToast, openToast };\n//# sourceMappingURL=Toast.js.map"]},"metadata":{},"sourceType":"module"}